scale_x_datetime(date_breaks=("2 hour"), date_labels=("%H:%M")) +
labs(title = "When Are You Most Likely to be Robbed?", x = "Hour of the day", y = "Crime Rate", subtitle="Most crimes in Lahore happened between 2.00pm and 8.00pm in January 2015.") +
t_title + t_axis + t_subtitle
ggplot(summ_times, aes(Time, freq)) + geom_point(col="tomato2", size=2) +
geom_smooth(method = "lm", se = FALSE) +
theme(aspect.ratio = .6) +
scale_x_datetime(date_breaks=("2 hour"), date_labels=("%H:%M")) +
labs(title = "When Are You Most Likely to be Robbed?", x = "Hour of the day", y = "Crime Rate", subtitle="Most crimes in Lahore happened between 2.00pm and 8.00pm in January 2015.") +
t_title + t_axis + t_subtitle
ggplot(summ_times, aes(Time, freq)) + geom_point(col="tomato2", size=1.5) +
geom_smooth(span = 0.2) +
theme(aspect.ratio = .6) +
scale_x_datetime(date_breaks=("2 hour"), date_labels=("%H:%M")) +
labs(title = "When Are You Most Likely to be Robbed?", x = "Hour of the day", y = "Crime Rate", subtitle="Most crimes in Lahore happened between 2.00pm and 8.00pm in January 2015.") +
t_title + t_axis + t_subtitle
ggplot(summ_times, aes(Time, freq)) + geom_point(col="tomato2", size=1.5) +
geom_smooth(span = 0.5) +
theme(aspect.ratio = .6) +
scale_x_datetime(date_breaks=("2 hour"), date_labels=("%H:%M")) +
labs(title = "When Are You Most Likely to be Robbed?", x = "Hour of the day", y = "Crime Rate", subtitle="Most crimes in Lahore happened between 2.00pm and 8.00pm in January 2015.") +
t_title + t_axis + t_subtitle
ggplot(summ_times, aes(Time, freq)) + geom_point(col="tomato2", size=1.5) +
geom_smooth(span = 0.1) +
theme(aspect.ratio = .6) +
scale_x_datetime(date_breaks=("2 hour"), date_labels=("%H:%M")) +
labs(title = "When Are You Most Likely to be Robbed?", x = "Hour of the day", y = "Crime Rate", subtitle="Most crimes in Lahore happened between 2.00pm and 8.00pm in January 2015.") +
t_title + t_axis + t_subtitle
ggplot(summ_times, aes(Time, freq)) + geom_point(col="tomato2", size=1.5) +
geom_smooth(span = 0.6) +
theme(aspect.ratio = .6) +
scale_x_datetime(date_breaks=("2 hour"), date_labels=("%H:%M")) +
labs(title = "When Are You Most Likely to be Robbed?", x = "Hour of the day", y = "Crime Rate", subtitle="Most crimes in Lahore happened between 2.00pm and 8.00pm in January 2015.") +
t_title + t_axis + t_subtitle
ggplot(summ_times, aes(Time, freq)) + geom_point(col="tomato2", size=1.5) +
geom_smooth(span = 0.4) +
theme(aspect.ratio = .6) +
scale_x_datetime(date_breaks=("2 hour"), date_labels=("%H:%M")) +
labs(title = "When Are You Most Likely to be Robbed?", x = "Hour of the day", y = "Crime Rate", subtitle="Most crimes in Lahore happened between 2.00pm and 8.00pm in January 2015.") +
t_title + t_axis + t_subtitle
ggplot(summ_times, aes(Time, freq)) + geom_point(col="tomato2", size=1.5) +
geom_smooth(method = "lm", formula = y ~ splines::bs(x, 3), se = FALSE) +
theme(aspect.ratio = .6) +
scale_x_datetime(date_breaks=("2 hour"), date_labels=("%H:%M")) +
labs(title = "When Are You Most Likely to be Robbed?", x = "Hour of the day", y = "Crime Rate", subtitle="Most crimes in Lahore happened between 2.00pm and 8.00pm in January 2015.") +
t_title + t_axis + t_subtitle
ggplot(summ_times, aes(Time, freq)) + geom_point(col="tomato2", size=1.5) +
geom_smooth(method = "lm", formula = y ~ x + I(x^2), size = 1) +
theme(aspect.ratio = .6) +
scale_x_datetime(date_breaks=("2 hour"), date_labels=("%H:%M")) +
labs(title = "When Are You Most Likely to be Robbed?", x = "Hour of the day", y = "Crime Rate", subtitle="Most crimes in Lahore happened between 2.00pm and 8.00pm in January 2015.") +
t_title + t_axis + t_subtitle
ggplot(summ_times, aes(Time, freq)) + geom_point(col="tomato2", size=1.5) +
geom_smooth(method="loess", span=0.1, se=TRUE, alpha=0.3) +
theme(aspect.ratio = .6) +
scale_x_datetime(date_breaks=("2 hour"), date_labels=("%H:%M")) +
labs(title = "When Are You Most Likely to be Robbed?", x = "Hour of the day", y = "Crime Rate", subtitle="Most crimes in Lahore happened between 2.00pm and 8.00pm in January 2015.") +
t_title + t_axis + t_subtitle
ggplot(summ_times, aes(Time, freq)) + geom_point(col="tomato2", size=1.5) +
geom_smooth(method="loess", span=0.4, se=TRUE, alpha=0.3) +
theme(aspect.ratio = .6) +
scale_x_datetime(date_breaks=("2 hour"), date_labels=("%H:%M")) +
labs(title = "When Are You Most Likely to be Robbed?", x = "Hour of the day", y = "Crime Rate", subtitle="Most crimes in Lahore happened between 2.00pm and 8.00pm in January 2015.") +
t_title + t_axis + t_subtitle
ggplot(summ_times, aes(Time, freq)) + geom_point(col="tomato2", size=1.5) +
geom_smooth(method="loess", span=0.4, se=TRUE, alpha=0.3) +
theme(aspect.ratio = .6) +
scale_x_datetime(date_breaks=("2 hour"), date_labels=("%H:%M")) +
labs(title = "When Are You Most Likely to be Robbed?", x = "Hour of the day", y = "Frequency of Crime Incidences every minute", subtitle="Most crimes in Lahore happened between 2.00pm and 8.00pm in January 2015.") +
t_title + t_axis + t_subtitle
summ_times
summ_times$five_min_int <- summ_times$Time %>% group_by(by15=cut(Time, "15 min")) %>%
summarise(count=sum(count))
summ_times$five_min_int <- summ_times %>% group_by(by15=cut(Time, "15 min")) %>%
summarise(count=sum(count))
summ_times$five_min_int <- summ_times %>% group_by(by15=cut(Time, "15 min")) %>%
summarise(freq = n())
summ_times
by_time <- group_by(FIR_2015_data, Time)
summ_times <- summarise(by_time, freq = n())
summ_times
summ_times$five_min_int <- summ_times %>% group_by(by15=cut(Time, "15 min")) %>%
summarise(freq = n())
by_time <- group_by(FIR_2015_data, Time)
summ_times <- summarise(by_time, freq = n())
summ_times
summ_times$Time <- as.POSIXct(summ_times$Time, format="%H%M%S")
summ_times
summ_times$five_min_int <- summ_times %>% group_by(by15=cut(Time, "5 min")) %>%
summarise(freq = n())
k <- summ_times %>% group_by(by15=cut(Time, "5 min")) %>%
summarise(freq = n())
k
by_5_mins <- summ_times %>% group_by(by5=cut(Time, "5 min")) %>%
summarise(freq = n())
ggplot(by_5_mins, aes(by15, freq)) + geom_point(col="tomato2", size=1.5) +
geom_smooth(method="loess", span=0.4, se=TRUE, alpha=0.3) +
theme(aspect.ratio = .6) +
scale_x_datetime(date_breaks=("2 hour"), date_labels=("%H:%M")) +
labs(title = "When Are You Most Likely to be Robbed?", x = "Hour of the day", y = "Frequency of Crime Incidences every minute", subtitle="Most crimes in Lahore happened between 2.00pm and 8.00pm in January 2015.") +
t_title + t_axis + t_subtitle
ggplot(by_5_mins, aes(by5, freq)) + geom_point(col="tomato2", size=1.5) +
geom_smooth(method="loess", span=0.4, se=TRUE, alpha=0.3) +
theme(aspect.ratio = .6) +
scale_x_datetime(date_breaks=("2 hour"), date_labels=("%H:%M")) +
labs(title = "When Are You Most Likely to be Robbed?", x = "Hour of the day", y = "Frequency of Crime Incidences every minute", subtitle="Most crimes in Lahore happened between 2.00pm and 8.00pm in January 2015.") +
t_title + t_axis + t_subtitle
by_5_mins
ggplot(by_5_mins, aes(by5, freq)) + geom_point(col="tomato2", size=1.5) +
geom_smooth(method="loess", span=0.4, se=TRUE, alpha=0.3) +
theme(aspect.ratio = .6) +
scale_x_datetime(date_breaks=("2 hour"), date_labels=("%H:%M")) +
labs(title = "When Are You Most Likely to be Robbed?", x = "Hour of the day", y = "Frequency of Crime Incidences every minute", subtitle="Most crimes in Lahore happened between 2.00pm and 8.00pm in January 2015.") +
t_title + t_axis + t_subtitle
summ_times$Time <- as.POSIXct(summ_times$Time, format="%H%M%S")
summ_times
by_5_mins <- summ_times %>% group_by(by5=cut(Time, "5 min")) %>%
summarise(freq = n())
by_5_mins
by_5_mins <- summ_times %>% group_by(by5=cut(Time, "5 min")) %>%
summarise(freq = n()) %>% as.POSIXct(format="%H%M%S")
by_5_mins <- summ_times %>% group_by(by5=cut(Time, "5 min")) %>%
summarise(freq = n())
by_5_mins <- as.POSIXct(summ_times$Time, format="%H%M%S")
ggplot(by_5_mins, aes(by5, freq)) + geom_point(col="tomato2", size=1.5) +
geom_smooth(method="loess", span=0.4, se=TRUE, alpha=0.3) +
theme(aspect.ratio = .6) +
scale_x_datetime(date_breaks=("2 hour"), date_labels=("%H:%M")) +
labs(title = "When Are You Most Likely to be Robbed?", x = "Hour of the day", y = "Frequency of Crime Incidences every minute", subtitle="Most crimes in Lahore happened between 2.00pm and 8.00pm in January 2015.") +
t_title + t_axis + t_subtitle
by_5_mins
summ_times$Time <- as.POSIXct(summ_times$Time, format="%H%M%S")
summ_times
by_5_mins <- summ_times %>% group_by(by5=cut(Time, "5 min")) %>%
summarise(freq = n())
by_5_mins$by5 <- as.POSIXct(summ_times$Time, format="%H%M%S")
by_5_mins <- summ_times %>% group_by(by5=cut(Time, "5 min")) %>%
summarise(freq = n())
by_5_mins$by5 <- as.POSIXct(summ_times$Time, format="%H%M%S")
by_5_mins$by5 <- as.POSIXct(by_5_mins$Time, format="%H%M%S")
by_5_mins
by_5_mins <- summ_times %>% group_by(by5=cut(Time, "5 min")) %>%
summarise(freq = n())
by_5_mins$by5 <- as.POSIXct(by_5_mins$Time, format="%H%M%S")
by_5_mins
ggplot(by_5_mins, aes(by5, freq)) + geom_point(col="tomato2", size=1.5) +
geom_smooth(method="loess", span=0.4, se=TRUE, alpha=0.3) +
theme(aspect.ratio = .6) +
scale_x_datetime(date_breaks=("2 hour"), date_labels=("%H:%M")) +
labs(title = "When Are You Most Likely to be Robbed?", x = "Hour of the day", y = "Frequency of Crime Incidences every minute", subtitle="Most crimes in Lahore happened between 2.00pm and 8.00pm in January 2015.") +
t_title + t_axis + t_subtitle
summ_times
ggplot(by_5_mins, aes(by5, freq)) + geom_point(col="tomato2", size=1.5) +
geom_smooth(method="loess", span=0.4, se=TRUE, alpha=0.3) +
theme(aspect.ratio = .6) +
scale_x_datetime(date_breaks=("2 hour"), date_labels=("%H:%M")) +
labs(title = "When Are You Most Likely to be Robbed?", x = "Hour of the day", y = "Frequency of Crime Incidences every minute", subtitle="Most crimes in Lahore happened between 2.00pm and 8.00pm in January 2015.") +
t_title + t_axis + t_subtitle
summ_times
ggplot(summ_times, aes(Time, freq)) + geom_point(col="tomato2", size=1.5) +
geom_smooth(method="loess", span=0.4, se=TRUE, alpha=0.3) +
theme(aspect.ratio = .6) +
scale_x_datetime(date_breaks=("2 hour"), date_labels=("%H:%M")) +
labs(title = "When Are You Most Likely to be Robbed?", x = "Hour of the day", y = "Frequency of Crime Incidences every minute", subtitle="Most crimes in Lahore happened between 2.00pm and 8.00pm in January 2015.") +
t_title + t_axis + t_subtitle
ggplot(summ_times, aes(Time, freq)) + geom_point(col="tomato2", size=1.5) +
geom_smooth(method="loess", span=0.4, se=TRUE, alpha=0.3) +
theme(aspect.ratio = .6) +
scale_x_datetime(date_breaks=("2 hour"), date_labels=("%H:%M")) +
labs(title = "When Are You Most Likely to be Robbed?", x = "Hour of the day", y = "Frequency of Crime Incidences every 5 minutes", subtitle="Most crimes in Lahore happened between 2.00pm and 8.00pm in January 2015.") +
t_title + t_axis + t_subtitle
ggplot(summ_times, aes(Time, freq)) + geom_point(col="tomato2", size=1.5) +
geom_smooth(method="loess", span=0.4, se=TRUE, alpha=0.3) +
theme(aspect.ratio = .6) +
scale_x_datetime(date_breaks=("2 hour"), date_labels=("%H:%M")) +
labs(title = "When Are You Most Likely to be Robbed?", x = "Hour of the day", y = "Frequency of Crime Incidences every 5 minutes", subtitle="Most crimes in Lahore happened between 2.00pm and 8.00pm in January 2015.", "Source: Punjab Police Department") +
t_title + t_axis + t_subtitle
ggplot(data=summ_crimes_by_neighborhood, aes(x = Neighborhood, y = `Crime Type`, size = freq)) +
geom_point() +
labs(title = "Which Crime Takes Place Where?", x = "Neighborhood", y = "Frequency of Crime Incidences", subtitle="Crime rate of different crime types in different neighborhoods of Lahore in January 2015.", caption = "Source: Punjab Police Department") +
t_title + t_axis + t_subtitle
ggplot(summ_times, aes(Time, freq)) + geom_point(col="tomato2", size=1.5) +
geom_smooth(method="loess", span=0.4, se=TRUE, alpha=0.3) +
theme(aspect.ratio = .6) +
scale_x_datetime(date_breaks=("2 hour"), date_labels=("%H:%M")) +
labs(title = "When Are You Most Likely to be Robbed?", x = "Hour of the day", y = "Frequency of Crime Incidences every 5 minutes", subtitle="Most crimes in Lahore happened between 2.00pm and 8.00pm in January 2015.", caption = "Source: Punjab Police Department") +
t_title + t_axis + t_subtitle
ggplot(data=summ_crimes_by_neighborhood, aes(x = Neighborhood, y= freq)) +
geom_bar(stat="identity", width=0.6, fill="tomato2") +
theme(aspect.ratio = .6) +
scale_y_continuous(breaks = (seq(0, 500, by = 50))) +
labs(title = "What Places in Lahore are Most Crime-Prone?", x = "Neighborhood", y = "Frequency of Crime Incidences", subtitle="Number of crime occurrences in different neighborhoods in January 2015.", caption = "Source: Punjab Police Department") +
t_title + t_axis + t_subtitle +
theme(axis.text.x = element_text(angle=65, vjust=0.6),
plot.background=element_rect(fill="#f7f7f7"))
ggplot(data=summ_crimes_by_neighborhood, aes(x = Neighborhood, y = `Crime Type`, size = freq)) +
geom_point() +
labs(title = "Which Crime Takes Place Where?", x = "Neighborhood", y = "Frequency of Crime Incidences", subtitle="Crime rate of different crime types in different neighborhoods of Lahore in January 2015.", caption = "Source: Punjab Police Department") +
t_title + t_axis + t_subtitle
FIR_2015_data$Date <- dmy(FIR_2015_data$Date)
FIR_2015_data$Date
FIR_2015_data$Date <- dmy(FIR_2015_data$Date)
FIR_2015_data <- read_csv("Data/Full_FIR_Details_2015(1).csv")
FIR_2015_data
class(FIR_2015_data) # a class of tibble
dim(FIR_2015_data) # 2243 rows and 6 columns
colnames(FIR_2015_data)[1] <- "Neighborhood"
t_title <- theme(plot.title = element_text(family="Times New Roman", face="bold", size=20, hjust=0.5))
t_axis <- theme(axis.title = element_text(family = "Arial",size=13))
t_subtitle <- theme(plot.subtitle=element_text(size=12, hjust=0.5, face="italic", color="black"))
FIR_2015_data$hour <- hour(FIR_2015_data$Time)
FIR_2015_data$hour
by_wday_crime_count <- FIR_2015_data %>% group_by(week_day, hour) %>% summarise(freq = n())
by_wday_crime_count
k <- "00"
by_wday_crime_count$hour <- paste(by_wday_crime_count$hour, k, sep =":")
FIR_2015_data$Date <- dmy(FIR_2015_data$Date)
FIR_2015_data$Date
FIR_2015_data$week_day <- wday(FIR_2015_data$Date, label = TRUE)
FIR_2015_data$week_day
FIR_2015_data$hour <- hour(FIR_2015_data$Time)
FIR_2015_data$hour
by_wday_crime_count <- FIR_2015_data %>% group_by(week_day, hour) %>% summarise(freq = n())
by_wday_crime_count
k <- "00"
by_wday_crime_count$hour <- paste(by_wday_crime_count$hour, k, sep =":")
ggplot(by_wday_crime_count, aes(x = hour, y = week_day, fill = freq)) +
geom_tile() +
scale_x_discrete(limits = c("0:00", "1:00", "2:00", "3:00", "4:00", "5:00", "6:00", "7:00", "8:00", "9:00", "10:00", "11:00", "12:00", "13:00", "14:00", "15:00", "16:00", "17:00", "18:00", "19:00", "20:00", "21:00", "22:00", "23:00")) +
scale_fill_gradient(low="#FFFB3F", high="#BA3833", limits=c(0, 80), na.value="transparent")
ggplot(by_wday_crime_count, aes(x = hour, y = week_day, fill = freq)) +
geom_tile() +
scale_x_discrete(limits = c("0:00", "1:00", "2:00", "3:00", "4:00", "5:00", "6:00", "7:00", "8:00", "9:00", "10:00", "11:00", "12:00", "13:00", "14:00", "15:00", "16:00", "17:00", "18:00", "19:00", "20:00", "21:00", "22:00", "23:00")) +
scale_fill_gradient(low="#FFFB3F", high="#BA3833", limits=c(0, 80), na.value="transparent") +
labs(title = "When Are You Most Likely to be Robbed?", x = "Hour of the day", y = "Frequency of Crime Incidences every 5 minutes", subtitle="Most crimes in Lahore happened between 2.00pm and 8.00pm in January 2015.", caption = "Source: Punjab Police Department") +
t_title + t_axis + t_subtitle
ggplot(by_wday_crime_count, aes(x = hour, y = week_day, fill = freq)) +
geom_tile() +
scale_x_discrete(limits = c("0:00", "1:00", "2:00", "3:00", "4:00", "5:00", "6:00", "7:00", "8:00", "9:00", "10:00", "11:00", "12:00", "13:00", "14:00", "15:00", "16:00", "17:00", "18:00", "19:00", "20:00", "21:00", "22:00", "23:00")) +
scale_fill_gradient(low="#FFFB3F", high="#BA3833", limits=c(0, 80), na.value="transparent") +
labs(title = "Crime Distribution Across Week Days", x = "Hour of the day", y = "Frequency of Crime Incidences every 5 minutes", subtitle="Most crimes in Lahore happened between 2.00pm and 8.00pm in January 2015.", caption = "Source: Punjab Police Department") +
t_title + t_axis + t_subtitle
ggplot(by_wday_crime_count, aes(x = hour, y = week_day, fill = freq)) +
geom_tile() +
scale_x_discrete(limits = c("0:00", "1:00", "2:00", "3:00", "4:00", "5:00", "6:00", "7:00", "8:00", "9:00", "10:00", "11:00", "12:00", "13:00", "14:00", "15:00", "16:00", "17:00", "18:00", "19:00", "20:00", "21:00", "22:00", "23:00")) +
scale_fill_gradient(low="#FFFB3F", high="#BA3833", limits=c(0, 80), na.value="transparent") +
labs(title = "Crime Distribution Across Week Days", x = "Hour of the day", y = "Day of the week", subtitle="Most crimes in Lahore happen on Thurs, Fri and Sat during midday and early afternoon on = "Source: Punjab Police Department") +
t_title + t_axis + t_subtitle
# Graph 5: facet grid
by_wday_area_crime_count <- FIR_2015_data %>% group_by(week_day, Neighborhood) %>% summarise(freq = n())
by_wday_area_crime_count
ggplot(by_wday_area_crime_count, aes(x = week_day, y = freq)) +
geom_bar(stat="identity", fill = "#7258BA") +
facet_wrap(~Neighborhood, ncol = 2) +
theme(aspect.ratio = 0.65) +
theme(axis.text.x = element_text(angle = 90),
strip.text = element_text(face = "plain",
size = rel(0.5)))
ggplot(by_wday_crime_count, aes(x = hour, y = week_day, fill = freq)) +
geom_tile() +
scale_x_discrete(limits = c("0:00", "1:00", "2:00", "3:00", "4:00", "5:00", "6:00", "7:00", "8:00", "9:00", "10:00", "11:00", "12:00", "13:00", "14:00", "15:00", "16:00", "17:00", "18:00", "19:00", "20:00", "21:00", "22:00", "23:00")) +
scale_fill_gradient(low="#FFFB3F", high="#BA3833", limits=c(0, 80), na.value="transparent") +
labs(title = "Crime Distribution Across Week Days", x = "Hour of the day", y = "Day of the week", subtitle="Most crimes in Lahore happen on Thurs, Fri and Sat during midday and early afternoon in January 2015." caption = "Source: Punjab Police Department") +
t_title + t_axis + t_subtitle
ggplot(by_wday_crime_count, aes(x = hour, y = week_day, fill = freq)) +
geom_tile() +
scale_x_discrete(limits = c("0:00", "1:00", "2:00", "3:00", "4:00", "5:00", "6:00", "7:00", "8:00", "9:00", "10:00", "11:00", "12:00", "13:00", "14:00", "15:00", "16:00", "17:00", "18:00", "19:00", "20:00", "21:00", "22:00", "23:00")) +
scale_fill_gradient(low="#FFFB3F", high="#BA3833", limits=c(0, 80), na.value="transparent") +
labs(title = "Crime Distribution Across Week Days", x = "Hour of the day", y = "Day of the week", subtitle="Most crimes in Lahore happen on Thurs, Fri and Sat during midday and early afternoon in January 2015." caption = "Source: Punjab Police Department") +
t_title + t_axis + t_subtitle
ggplot(by_wday_crime_count, aes(x = hour, y = week_day, fill = freq)) +
geom_tile() +
scale_x_discrete(limits = c("0:00", "1:00", "2:00", "3:00", "4:00", "5:00", "6:00", "7:00", "8:00", "9:00", "10:00", "11:00", "12:00", "13:00", "14:00", "15:00", "16:00", "17:00", "18:00", "19:00", "20:00", "21:00", "22:00", "23:00")) +
scale_fill_gradient(low="#FFFB3F", high="#BA3833", limits=c(0, 80), na.value="transparent") +
labs(title = "Crime Distribution Across Week Days", x = "Hour of the day", y = "Day of the week", subtitle="Most crimes in Lahore happen on Thurs, Fri and Sat during midday and early afternoon in January 2015.", caption = "Source: Punjab Police Department") +
t_title + t_axis + t_subtitle
by_wday_area_crime_count <- FIR_2015_data %>% group_by(week_day, Neighborhood) %>% summarise(freq = n())
by_wday_area_crime_count
ggplot(by_wday_area_crime_count, aes(x = week_day, y = freq)) +
geom_bar(stat="identity", fill = "#7258BA") +
facet_wrap(~Neighborhood, ncol = 2) +
theme(aspect.ratio = 0.65) +
theme(axis.text.x = element_text(angle = 90),
strip.text = element_text(face = "plain",
size = rel(0.5)))
ggplot(by_wday_area_crime_count, aes(x = week_day, y = freq)) +
geom_bar(stat="identity", fill = "#7258BA") +
facet_wrap(~Neighborhood, ncol = 2) +
labs(title = "Crime Distribution Across Week Days", x = "Hour of the day", y = "Day of the week", subtitle="Most crimes in Lahore occurred on Thurs, Fri and Sat during midday and early afternoon in January 2015.", caption = "Source: Punjab Police Department") +
t_title + t_axis + t_subtitle +
theme(aspect.ratio = 0.65) +
theme(axis.text.x = element_text(angle = 90),
strip.text = element_text(face = "plain",
size = rel(0.5)))
ggplot(by_wday_area_crime_count, aes(x = week_day, y = freq)) +
geom_bar(stat="identity", fill = "#7258BA") +
facet_wrap(~Neighborhood, ncol = 2) +
labs(title = "In Lahore, Be Careful on Weekends", x = "Hour of the day", y = "Day of the week", subtitle="Most crimes in Lahore occurred on Thurs, Fri and Sat during midday and early afternoon in January 2015.", caption = "Source: Punjab Police Department") +
t_title + t_axis + t_subtitle +
theme(aspect.ratio = 0.65) +
theme(axis.text.x = element_text(angle = 90),
strip.text = element_text(face = "plain",
size = rel(0.5)))
ggplot(by_wday_area_crime_count, aes(x = week_day, y = freq)) +
geom_bar(stat="identity", fill = "#7258BA") +
facet_wrap(~Neighborhood, ncol = 2) +
labs(title = "In Lahore, Be Careful on Weekends", x = "Hour of the day", y = "Total Crime Incidences (in January 2015)", subtitle="Most crimes in Lahore occurred on Thurs, Fri and Sat during midday and early afternoon in January 2015.", caption = "Source: Punjab Police Department") +
t_title + t_axis + t_subtitle +
theme(aspect.ratio = 0.65) +
theme(axis.text.x = element_text(angle = 90),
strip.text = element_text(face = "plain",
size = rel(0.5)))
ggplot(by_wday_area_crime_count, aes(x = week_day, y = freq)) +
geom_bar(stat="identity", fill = "#7258BA") +
facet_wrap(~Neighborhood, ncol = 2) +
labs(title = "In Lahore, Be Careful on Weekends", x = "Hour of the day", y = "Total Crime Incidences (January 2015)", subtitle="Most crimes in Lahore occurred on Thurs, Fri and Sat during midday and early afternoon in January 2015.", caption = "Source: Punjab Police Department") +
t_title + t_axis + t_subtitle +
theme(aspect.ratio = 0.65) +
theme(axis.text.x = element_text(angle = 90),
strip.text = element_text(face = "plain",
size = rel(0.5)))
ggplot(by_wday_area_crime_count, aes(x = week_day, y = freq)) +
geom_bar(stat="identity", fill = "#7258BA") +
facet_wrap(~Neighborhood, ncol = 2) +
labs(title = "In Lahore, Be Careful on Weekends", x = "Hour of the day", y = "Total Crime Incidences in January 2015", subtitle="Most crimes in Lahore occurred on Thurs, Fri and Sat during midday and early afternoon in January 2015.", caption = "Source: Punjab Police Department") +
t_title + t_axis + t_subtitle +
theme(aspect.ratio = 0.65) +
theme(axis.text.x = element_text(angle = 90),
strip.text = element_text(face = "plain",
size = rel(0.5)))
theme_set(theme_classic())
ggplot(by_wday_area_crime_count, aes(x = week_day, y = freq)) +
geom_bar(stat="identity", fill = "#7258BA") +
facet_wrap(~Neighborhood, ncol = 2) +
labs(title = "In Lahore, Be Careful on Weekends", x = "Hour of the day", y = "Total Crime Incidences in January 2015", subtitle="Most crimes in Lahore occurred on Thurs, Fri and Sat during midday and early afternoon in January 2015.", caption = "Source: Punjab Police Department") +
t_title + t_axis + t_subtitle +
theme(aspect.ratio = 0.65) +
theme(axis.text.x = element_text(angle = 90),
strip.text = element_text(face = "plain",
size = rel(0.5)))
ggplot(by_wday_area_crime_count, aes(x = week_day, y = freq)) +
geom_bar(stat="identity", fill = "#7258BA") +
facet_wrap(~Neighborhood, ncol = 2) +
labs(title = "In Lahore, Be Careful on Weekends", x = "Day of the Week", y = "Total Crime Incidences in January 2015", subtitle="Most crimes in Lahore occurred on Thurs, Fri and Sat during midday and early afternoon in January 2015.", caption = "Source: Punjab Police Department") +
t_title + t_axis + t_subtitle +
theme(aspect.ratio = 0.65) +
theme(axis.text.x = element_text(angle = 90),
strip.text = element_text(face = "plain",
size = rel(0.5)))
t_caption <- theme(plot.caption=element_text(size=5, face="italic", color="black"))
ggplot(by_wday_area_crime_count, aes(x = week_day, y = freq)) +
geom_bar(stat="identity", fill = "#7258BA") +
facet_wrap(~Neighborhood, ncol = 2) +
labs(title = "In Lahore, Be Careful on Weekends", x = "Day of the Week", y = "Total Crime Incidences in January 2015", subtitle="Most crimes in Lahore occurred on Thurs, Fri and Sat during midday and early afternoon in January 2015.", caption = "Source: Punjab Police Department") +
t_title + t_axis + t_subtitle + t_caption +
theme(aspect.ratio = 0.65) +
theme(axis.text.x = element_text(angle = 90),
strip.text = element_text(face = "plain",
size = rel(0.5)))
t_axis <- theme(axis.title = element_text(family = "Arial",size=11))
t_title <- theme(plot.title = element_text(family="Times New Roman", face="bold", size=20, hjust=0.5))
t_axis <- theme(axis.title = element_text(family = "Arial",size=11))
t_subtitle <- theme(plot.subtitle=element_text(size=11, hjust=0.5, face="italic", color="black"))
ggplot(by_wday_area_crime_count, aes(x = week_day, y = freq)) +
geom_bar(stat="identity", fill = "#7258BA") +
facet_wrap(~Neighborhood, ncol = 2) +
labs(title = "In Lahore, Be Careful on Weekends", x = "Day of the Week", y = "Total Crime Incidences in January 2015", subtitle="Most crimes in Lahore occurred on Thurs, Fri and Sat during midday and early afternoon in January 2015.", caption = "Source: Punjab Police Department") +
t_title + t_axis + t_subtitle + t_caption +
theme(aspect.ratio = 0.65) +
theme(axis.text.x = element_text(angle = 90),
strip.text = element_text(face = "plain",
size = rel(0.5)))
library("extrafont")
install.packages("extrafont")
font_import() # import all your fonts
fonts() #get a list of fonts
library("extrafont")
font_import() # import all your fonts
install.packages("rmarkdown")
library("rmarkdown")
fonts() #get a list of fonts
fonttable()
fonttable()[40:45,]
t_title <- theme(plot.title = element_text(family="Andale Mono", face="bold", size=20, hjust=0.5))
ggplot(data=summ_crimes_by_neighborhood, aes(x = Neighborhood, y= freq)) +
geom_bar(stat="identity", width=0.6, fill="tomato2") +
theme(aspect.ratio = .6) +
scale_y_continuous(breaks = (seq(0, 500, by = 50))) +
labs(title = "What Places in Lahore are Most Crime-Prone?", x = "Neighborhood", y = "Frequency of Crime Incidences", subtitle="Number of crime occurrences in different neighborhoods in January 2015.", caption = "Source: Punjab Police Department") +
t_title + t_axis + t_subtitle +
theme(axis.text.x = element_text(angle=65, vjust=0.6),
plot.background=element_rect(fill="#f7f7f7"))
t_title <- theme(plot.title = element_text(family="Humor Sans", face="bold", size=20, hjust=0.5))
ggplot(data=summ_crimes_by_neighborhood, aes(x = Neighborhood, y= freq)) +
geom_bar(stat="identity", width=0.6, fill="tomato2") +
theme(aspect.ratio = .6) +
scale_y_continuous(breaks = (seq(0, 500, by = 50))) +
labs(title = "What Places in Lahore are Most Crime-Prone?", x = "Neighborhood", y = "Frequency of Crime Incidences", subtitle="Number of crime occurrences in different neighborhoods in January 2015.", caption = "Source: Punjab Police Department") +
t_title + t_axis + t_subtitle +
theme(axis.text.x = element_text(angle=65, vjust=0.6),
plot.background=element_rect(fill="#f7f7f7"))
grace
t_title <- theme(plot.title = element_text(family="grace", face="bold", size=20, hjust=0.5))
ggplot(data=summ_crimes_by_neighborhood, aes(x = Neighborhood, y= freq)) +
geom_bar(stat="identity", width=0.6, fill="tomato2") +
theme(aspect.ratio = .6) +
scale_y_continuous(breaks = (seq(0, 500, by = 50))) +
labs(title = "What Places in Lahore are Most Crime-Prone?", x = "Neighborhood", y = "Frequency of Crime Incidences", subtitle="Number of crime occurrences in different neighborhoods in January 2015.", caption = "Source: Punjab Police Department") +
t_title + t_axis + t_subtitle +
theme(axis.text.x = element_text(angle=65, vjust=0.6),
plot.background=element_rect(fill="#f7f7f7"))
knit_with_parameters('~/Desktop/MSCAPP (Quarter 4)/Data Viz for Public Policy/data-viz-for-public-policy-fall-2017/Assignment_3/Assignment3.Rmd')
library("dplyr")
library("readr")
library("ggplot2")
library("lubridate")
library("viridis")
library("extrafont")
library("rmarkdown")
knitr::opts_chunk$set(echo = TRUE)
FIR_2015_data <- read_csv("Data/Full_FIR_Details_2015(1).csv")
FIR_2015_data
class(FIR_2015_data) # a class of tibble
dim(FIR_2015_data) # 2243 rows and 6 columns
colnames(FIR_2015_data)[1] <- "Neighborhood"
t_title <- theme(plot.title = element_text(family="grace", face="bold", size=20, hjust=0.5))
t_axis <- theme(axis.title = element_text(family = "Arial",size=11))
t_subtitle <- theme(plot.subtitle=element_text(size=11, hjust=0.5, face="italic", color="black"))
t_caption <- theme(plot.caption=element_text(size=6, face="italic", color="black"))
library("readr")
knitr::opts_chunk$set(echo = TRUE)
FIR_2015_data <- read_csv("Data/Full_FIR_Details_2015(1).csv")
FIR_2015_data
class(FIR_2015_data) # a class of tibble
dim(FIR_2015_data) # 2243 rows and 6 columns
# rename a variable name
colnames(FIR_2015_data)[1] <- "Neighborhood"
# Common themes for axes
t_title <- theme(plot.title = element_text(family="grace", face="bold", size=20, hjust=0.5))
t_axis <- theme(axis.title = element_text(family = "Arial",size=11))
t_subtitle <- theme(plot.subtitle=element_text(size=11, hjust=0.5, face="italic", color="black"))
t_caption <- theme(plot.caption=element_text(size=6, face="italic", color="black"))
FIR_2015_data <- read_csv("Data/Full_FIR_Details_2015(1).csv")
FIR_2015_data
class(FIR_2015_data) # a class of tibble
dim(FIR_2015_data) # 2243 rows and 6 columns
# rename a variable name
colnames(FIR_2015_data)[1] <- "Neighborhood"
# Common themes for axes
t_title <- theme(plot.title = element_text(family="grace", face="bold", size=20, hjust=0.5))
t_axis <- theme(axis.title = element_text(family = "Arial",size=11))
t_subtitle <- theme(plot.subtitle=element_text(size=11, hjust=0.5, face="italic", color="black"))
t_caption <- theme(plot.caption=element_text(size=6, face="italic", color="black"))
knitr::opts_chunk$set(echo = TRUE)
FIR_2015_data <- read_csv("Data/Full_FIR_Details_2015(1).csv")
FIR_2015_data
class(FIR_2015_data) # a class of tibble
dim(FIR_2015_data) # 2243 rows and 6 columns
# rename a variable name
colnames(FIR_2015_data)[1] <- "Neighborhood"
# Common themes for axes
t_title <- theme(plot.title = element_text(family="grace", face="bold", size=20, hjust=0.5))
t_axis <- theme(axis.title = element_text(family = "Arial",size=11))
t_subtitle <- theme(plot.subtitle=element_text(size=11, hjust=0.5, face="italic", color="black"))
t_caption <- theme(plot.caption=element_text(size=6, face="italic", color="black"))
library("dplyr")
library("readr")
library("ggplot2")
library("lubridate")
library("viridis")
library("extrafont")
library("rmarkdown")
```{r loading data, message=FALSE}
theme_set(theme_classic())
summ_crimes_by_neighborhood <- group_by(FIR_2015_data, Neighborhood, `Crime Type`) %>%
summarise(freq = n())
ggplot(data=summ_crimes_by_neighborhood, aes(x = Neighborhood, y= freq)) +
geom_bar(stat="identity", width=0.6, fill="tomato2") +
theme(aspect.ratio = .6) +
scale_y_continuous(breaks = (seq(0, 500, by = 50))) +
labs(title = "What Places in Lahore are Most Crime-Prone?", x = "Neighborhood", y = "Frequency of Crime Incidences", subtitle="Number of crime occurrences in different neighborhoods in January 2015.", caption = "Source: Punjab Police Department") +
t_title + t_axis + t_subtitle +
theme(axis.text.x = element_text(angle=65, vjust=0.6),
plot.background=element_rect(fill="#f7f7f7"))
by_wday_area_crime_count <- FIR_2015_data %>% group_by(week_day, Neighborhood) %>% summarise(freq = n())
FIR_2015_data$Date <- dmy(FIR_2015_data$Date)
by_wday_crime_count <- FIR_2015_data %>% group_by(week_day, hour) %>% summarise(freq = n())
k <- "00"
by_wday_crime_count$hour <- paste(by_wday_crime_count$hour, k, sep =":")
by_wday_area_crime_count <- FIR_2015_data %>% group_by(week_day, Neighborhood) %>% summarise(freq = n())
ggplot(by_wday_area_crime_count, aes(x = week_day, y = freq)) +
geom_bar(stat="identity", fill = "#7258BA") +
facet_wrap(~Neighborhood, ncol = 2) +
labs(title = "In Lahore, Be Careful on Weekends", x = "Day of the Week", y = "Total Crime Incidences in January 2015", subtitle="Most crimes in Lahore occurred on Thurs, Fri and Sat during midday and early afternoon in January 2015.", caption = "Source: Punjab Police Department") +
t_title + t_axis + t_subtitle + t_caption +
theme(aspect.ratio = 0.65) +
theme(axis.text.x = element_text(angle = 90),
strip.text = element_text(face = "plain",
size = rel(0.5)))
by_time <- group_by(FIR_2015_data, Time)
summ_times$Time <- as.POSIXct(summ_times$Time, format="%H%M%S")
ggplot(summ_times, aes(Time, freq)) + geom_point(col="tomato2", size=1.5) +
geom_smooth(method="loess", span=0.4, se=TRUE, alpha=0.3) +
theme(aspect.ratio = .6) +
scale_x_datetime(date_breaks=("2 hour"), date_labels=("%H:%M")) +
labs(title = "When Are You Most Likely to be Robbed?", x = "Hour of the day", y = "Total Crime Incidences every 5 minutes", subtitle="Most crimes in Lahore happened between 2.00pm and 8.00pm in January 2015.", caption = "Source: Punjab Police Department") +
t_title + t_axis + t_subtitle
theme_set(theme_bw())
ggplot(data=summ_crimes_by_neighborhood, aes(x = Neighborhood, y = `Crime Type`, size = freq)) +
geom_point() +
labs(title = "Which Crime Takes Place Where?", x = "Neighborhood", y = "Total Crime Incidences (January 2015)", subtitle="Crime rate of different crime types in different neighborhoods of Lahore in January 2015.", caption = "Source: Punjab Police Department") +
t_title + t_axis + t_subtitle
t_caption <- theme(plot.caption=element_text(size=4, face="italic", color="black"))
