cylindercount = factor(autodata$cyl, labels=c('one', 'six','four','eight'))
cylindercount = factor(autodata$cyl, labels=c('one','six','four','eight'))
install.packages("dplyr")
library(dplyr)
data(mtcars)
head(mtcars, 10)
sum(x<-1:5)
x
sum(y=1:5)
y
library()
search()
install.packages("ggplot2")
mtcars$mpg
len(mtcars$mpg)
length(mtcars$mpg)
install.packages("tidyverse")
library("tidverse")
library("tidyverse")
?function_name
?function_name("tidyverse")
?function_name()
?function_name("dplyr")
?function_name("dplyr")
cars
?cars
tib <- as_tibble(mtcars)
tib
tib$'carb'
#
savehistory("~/Desktop/MSCAPP (Quarter 4)/Data Viz for Public Policy/R practise full code -  Session 3 -Oct 2.Rhistory")
lahore_crime_14$datetime <- strptime(datetime)[
lahore_crime_14$datetime
lahore_crime_14$datetime <- strptime(datetime)
lahore_crime_14$datetime
lahore_crime_14$datetime <- strptime(datetime)
library("dplyr")
library("readr")
library("ggplot2")
library("lubridate")
library("knitr")
library("ggthemes")
library("jsonlite")
library("dplyr")
library("readr")
library("ggplot2")
library("lubridate")
library("knitr")
library("xtable")
library("ggthemes")
library("tidyverse")
library("treemapify")
library("rgdal")
# reading the data
FIR_crime_data <- read_csv("Full_FIR_Details_2008to2015.csv")
getwd()
setwd("/Users/faraaz/Desktop/MSCAPP (Quarter 4)/Data Viz for Public Policy/data-viz-for-public-policy-fall-2017/static_viz_final/Assignment_4/Data/")
FIR_crime_data <- read_csv("Full_FIR_Details_2008to2015.csv")
FIR_crime_data$`Crime Type` <- ifelse(FIR_crime_data$`Crime Type` == "bulgery", "burglary", FIR_crime_data$`Crime Type`)
# rename a variable name
colnames(FIR_crime_data)[1] <- "Neighborhood"
# filter the data for only 2014
FIR_crime_data$year <- substring(FIR_crime_data$Date,7,10)
new <- FIR_crime_data %>% filter(year=="14")
# Common themes for axes
#t_title <- theme(plot.title = element_text(family="Palatino", face="bold", size=20, hjust=0, margin = margin(0, 22, 0, 0)))
ordinalColorScale_color = scale_color_brewer(palette = "Dark2")
ordinalColorScale_fill = scale_fill_brewer(palette = "Dark2")
continuousColorScale <- function(upperLimit)
{
colorCont = scale_fill_gradient(low="#f8d5d4", high="#E82D17", limits=c(0, upperLimit))
return(colorCont)
}
theme_fancy <- theme(plot.title = element_text(family="Palatino", face="bold", size=18, hjust=0, margin = margin(0, 22, 0, 0)),
plot.subtitle=element_text(size=13, family="Georgia", hjust=0, face="italic", color="#8E8883", margin = margin(10, 22, 22, 0)),
axis.title = element_text(family = "Franklin Gothic Book",size=12, color="#000000", margin = margin(22, 0, 22, 0)),
axis.text=element_text(size=10),
plot.caption=element_text(family = "Georgia", hjust = 0, size=9, face="italic", color="black"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line( size=.3, color="white" ),
panel.grid.minor.y = element_blank(),
plot.background = element_rect(fill = '#fce39e'),
panel.background = element_rect(fill = '#fce39e'),
legend.title = element_text(colour="black", size=10, face="bold"),
legend.background = element_rect(fill="#fce39e")
)
theme_simple <- theme(plot.title = element_text(family="Palatino", face="bold", size=18, hjust=0, margin = margin(0, 22, 0, 0)),
plot.subtitle=element_text(size=13, family="Georgia", hjust=0, face="italic", color="#8E8883", margin = margin(10, 22, 22, 0)),
axis.title = element_text(family = "Franklin Gothic Book",size=12, color="#000000", margin = margin(22, 0, 22, 0)),
axis.text=element_text(size=10),
plot.caption=element_text(family = "Georgia", hjust = 0, size=9, face="italic", color="black")
)
# summary stats for each year
#------TABLE-------#
#by_neighborhood_only <- group_by(new, Neighborhood)
#summ_crimes_by_neighborhood_only <-  summarise(by_neighborhood_only, freq = n()) %>%
#  arrange(desc(freq))
#Graph 1: Bar Chart
by_neighborhood <- group_by(new, Neighborhood, `Crime Type`)
summ_crimes_by_neighborhood_and_type <- summarise(by_neighborhood, freq = n())
ggplot(data=summ_crimes_by_neighborhood_and_type, aes(x = Neighborhood, y= freq)) +
geom_bar(stat="identity", width=0.7, fill="tomato2") +
theme(aspect.ratio = .6) +
scale_y_continuous(breaks = (seq(0, 15000, by = 2500))) +
labs(title = "South of Lahore is the most dangerous part of the city", x = "Neighborhood", y = "Number of Crime Incidences", subtitle="Highest number of crime occurrences took place in the Southeast part of Lahore in 2014.", caption = "Source: Punjab Police Department") +
scale_x_discrete(limits=c("Cantonment", "Data Gunj Baksh", "Nishtar Town", "Aziz Bhatti Town", "Gulberg Town", "Iqbal Town", "Ravi Town", "Samanabad Town", "Wagha Town")) +
theme_fancy +
#geom_vline(xintercept = 1, yintercept = 2500, color = "red", linetype = "dashed") +
#annotate("text", x = c(2,4,6,8), y=10000, label = c("two", "ship", "six", "boat")) +
theme(axis.text.x = element_text(angle=65, vjust=0.6))
ggplot(data=summ_crimes_by_neighborhood_and_type, aes(x = Neighborhood, y= freq)) +
geom_bar(stat="identity", width=0.7, fill="tomato2") +
theme(aspect.ratio = .6) +
scale_y_continuous(breaks = (seq(0, 15000, by = 2500))) +
labs(title = "South of Lahore is the most dangerous part of the city", x = "Neighborhood", y = "Number of Crime Incidences", subtitle="Highest number of crime occurrences took place in the Southeast part of Lahore in 2014.", caption = "Source: Punjab Police Department") +
scale_x_discrete(limits=c("Iqbal Town", "Nishtar Town", "Ravi Town", "Shalamar Town", "Cantonment", "Wagha Town", "Aziz Bhatti Town", "Data Gunj Baksh", "Samanabad Town", "Gulberg Town")) +
theme_fancy +
#geom_vline(xintercept = 1, yintercept = 2500, color = "red", linetype = "dashed") +
#annotate("text", x = c(2,4,6,8), y=10000, label = c("two", "ship", "six", "boat")) +
theme(axis.text.x = element_text(angle=65, vjust=0.6))
ggplot(data=summ_crimes_by_neighborhood_and_type, aes(x = Neighborhood, y= freq)) +
geom_bar(stat="identity", width=0.7, fill="tomato2") +
theme(aspect.ratio = .6) +
scale_y_continuous(breaks = (seq(0, 15000, by = 2500))) +
labs(title = "South of Lahore is the most dangerous part of the city", x = "Neighborhood", y = "Number of Crime Incidences", subtitle="Highest number of crime occurrences took place in the Southeast part of Lahore in 2014.", caption = "Source: Punjab Police Department") +
scale_x_discrete(limits=c("Iqbal Town", "Nishtar Town", "Ravi Town", "Shalamar Town", "Cantonment", "Wagha Town", "Aziz Bhatti Town", "Data Gunj Baksh", "Samanabad Town", "Gulberg Town")) +
theme_fancy +
#geom_vline(xintercept = 1, yintercept = 2500, color = "red", linetype = "dashed") +
#annotate("text", x = c(2,4,6,8), y=10000, label = c("two", "ship", "six", "boat")) +
theme(axis.text.x = element_text(angle=65, vjust=0.6))
library("ggplot2")
ggplot(data=summ_crimes_by_neighborhood_and_type, aes(x = Neighborhood, y= freq)) +
geom_bar(stat="identity", width=0.7, fill="tomato2") +
theme(aspect.ratio = .6) +
scale_y_continuous(breaks = (seq(0, 15000, by = 2500))) +
labs(title = "South of Lahore is the most dangerous part of the city", x = "Neighborhood", y = "Number of Crime Incidences", subtitle="Highest number of crime occurrences took place in the Southeast part of Lahore in 2014.", caption = "Source: Punjab Police Department") +
scale_x_discrete(limits=c("Iqbal Town", "Nishtar Town", "Ravi Town", "Shalamar Town", "Cantonment", "Wagha Town", "Aziz Bhatti Town", "Data Gunj Baksh", "Samanabad Town", "Gulberg Town")) +
theme_fancy +
#geom_vline(xintercept = 1, yintercept = 2500, color = "red", linetype = "dashed") +
#annotate("text", x = c(2,4,6,8), y=10000, label = c("two", "ship", "six", "boat")) +
theme(axis.text.x = element_text(angle=65, vjust=0.6))
ggplot(data=summ_crimes_by_neighborhood_and_type, aes(x = Neighborhood, y= freq)) +
geom_bar(stat="identity", width=0.7, fill="tomato2") +
theme(aspect.ratio = .6) +
scale_y_continuous(breaks = (seq(0, 15000, by = 2500))) +
labs(title = "South of Lahore is the most dangerous part of the city", x = "Neighborhood", y = "Number of Crime Incidences", subtitle="Highest number of crime occurrences took place in the Southeast part of Lahore in 2014.", caption = "Source: Punjab Police Department") +
scale_x_discrete(limits=c("Iqbal Town", "Nishtar Town", "Ravi Town", "Shalamar Town", "Cantonment", "Wagha Town", "Aziz Bhatti Town", "Data Gunj Baksh", "Samanabad Town", "Gulberg Town")) +
theme_fancy +
#geom_vline(xintercept = 1, yintercept = 2500, color = "red", linetype = "dashed") +
#annotate("text", x = c(2,4,6,8), y=10000, label = c("two", "ship", "six", "boat")) +
theme(axis.text.x = element_text(angle=65, vjust=0.6))
ggplot(data=summ_crimes_by_neighborhood_and_type, aes(x = Neighborhood, y= freq)) +
geom_bar(stat="identity", width=0.7, fill="tomato2") +
theme(aspect.ratio = .6) +
scale_y_continuous(breaks = (seq(0, 15000, by = 2500))) +
labs(title = "South of Lahore is the most dangerous part of the city", x = "Neighborhood", y = "Number of Crime Incidences", subtitle="Highest number of crime occurrences took place in the Southeast part of Lahore in 2014.", caption = "Source: Punjab Police Department") +
scale_x_discrete(limits=c("Iqbal Town", "Nishtar Town", "Ravi Town", "Shalamar Town", "Cantonment", "Wagha Town", "Aziz Bhatti Town", "Data Gunj Baksh", "Samanabad Town", "Gulberg Town")) +
theme_fancy +
#geom_vline(xintercept = 1, yintercept = 2500, color = "red", linetype = "dashed") +
#annotate("text", x = c(2,4,6,8), y=10000, label = c("two", "ship", "six", "boat")) +
theme(axis.text.x = element_text(angle=65, vjust=0.6))
ggplot(data=summ_crimes_by_neighborhood_and_type, aes(x = Neighborhood, y= freq)) +
geom_bar(stat="identity", width=0.7, fill="tomato2") +
theme(aspect.ratio = .6) +
scale_y_continuous(breaks = (seq(0, 15000, by = 2500))) +
labs(title = "South of Lahore is the most dangerous part of the city", x = "Neighborhood", y = "Number of Crime Incidences", subtitle="Highest number of crime occurrences took place in the Southeast part of Lahore in 2014.", caption = "Source: Punjab Police Department") +
scale_x_discrete(limits=c("Iqbal Town", "Nishtar Town", "Ravi Town", "Shalamar Town", "Cantonment", "Wagha Town", "Aziz Bhatti Town", "Data Gunj Baksh", "Samanabad Town", "Gulberg Town")) +
theme_fancy +
#geom_vline(xintercept = 1, yintercept = 2500, color = "red", linetype = "dashed") +
annotate("text", x = c(2,4,6,8), y=10000, label = c("two", "ship", "six", "boat")) +
theme(axis.text.x = element_text(angle=65, vjust=0.6))
ggplot(data=summ_crimes_by_neighborhood_and_type, aes(x = Neighborhood, y= freq)) +
geom_bar(stat="identity", width=0.7, fill="tomato2") +
theme(aspect.ratio = .6) +
scale_y_continuous(breaks = (seq(0, 15000, by = 2500))) +
labs(title = "South of Lahore is the most dangerous part of the city", x = "Neighborhood", y = "Number of Crime Incidences", subtitle="Highest number of crime occurrences took place in the Southeast part of Lahore in 2014.", caption = "Source: Punjab Police Department") +
scale_x_discrete(limits=c("Iqbal Town", "Nishtar Town", "Ravi Town", "Shalamar Town", "Cantonment", "Wagha Town", "Aziz Bhatti Town", "Data Gunj Baksh", "Samanabad Town", "Gulberg Town")) +
theme_fancy +
#geom_vline(xintercept = 1, yintercept = 2500, color = "red", linetype = "dashed") +
annotate("text", x = c(2,4,6,8), y=10000, label = c("two", "ship", "six", "boat")) +
theme(axis.text.x = element_text(angle=65, vjust=0.6))
getwd()
library("dplyr")
library("readr")
library("ggplot2")
library("lubridate")
library("knitr")
library("xtable")
library("ggthemes")
library("tidyverse")
library("treemapify")
library("rgdal")
# create a common color scheme for ordinal and continuous values
ordinalColorScale_color = scale_color_brewer(palette = "Dark2")
ordinalColorScale_fill = scale_fill_brewer(palette = "Dark2")
continuousColorScale <- function(upperLimit)
{
colorCont = scale_fill_gradient(low="#f8d5d4", high="#E82D17", limits=c(0, upperLimit))
return(colorCont)
}
# I have made two themes: a fancy theme (with panel background color) and a simple theme (without a panel background color)
theme_fancy <- theme(plot.title = element_text(family="Palatino", face="bold", size=18, hjust=0, margin = margin(0, 22, 0, 0)),
plot.subtitle=element_text(size=13, family="Georgia", hjust=0, face="italic", color="#8E8883", margin = margin(10, 22, 22, 0)),
axis.title = element_text(family = "Franklin Gothic Book",size=12, color="#000000", margin = margin(22, 0, 22, 0)),
axis.text=element_text(size=10),
plot.caption=element_text(family = "Georgia", hjust = 0, size=9, face="italic", color="black"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line( size=.3, color="white" ),
panel.grid.minor.y = element_blank(),
plot.background = element_rect(fill = '#fce39e'),
panel.background = element_rect(fill = '#fce39e'),
legend.title = element_text(colour="black", size=10, face="bold"),
legend.background = element_rect(fill="#fce39e")
)
theme_simple <- theme(plot.title = element_text(family="Palatino", face="bold", size=18, hjust=0, margin = margin(0, 22, 0, 0)),
plot.subtitle=element_text(size=13, family="Georgia", hjust=0, face="italic", color="#8E8883", margin = margin(10, 22, 22, 0)),
axis.title = element_text(family = "Franklin Gothic Book",size=12, color="#000000", margin = margin(22, 0, 22, 0)),
axis.text=element_text(size=10),
plot.caption=element_text(family = "Georgia", hjust = 0, size=9, face="italic", color="black")
)
theme_fancy <- theme(plot.title = element_text(family="Palatino", face="bold", size=18, hjust=0, margin = margin(0, 22, 0, 0)),
plot.subtitle=element_text(size=13, family="Georgia", hjust=0, face="italic", color="#8E8883", margin = margin(10, 22, 22, 0)),
axis.title = element_text(family = "Franklin Gothic Book",size=12, color="#000000", margin = margin(22, 0, 22, 0)),
axis.text=element_text(size=10),
plot.caption=element_text(family = "Georgia", hjust = 0, size=9, face="italic", color="black"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line( size=.3, color="white" ),
panel.grid.minor.y = element_blank(),
plot.background = element_rect(fill = '#fce39e'),
panel.background = element_rect(fill = '#fce39e'),
legend.title = element_text(colour="black", size=10, face="bold"),
legend.background = element_rect(fill="#fce39e")
)
theme_simple <- theme(plot.title = element_text(family="Palatino", face="bold", size=18, hjust=0, margin = margin(0, 22, 0, 0)),
plot.subtitle=element_text(size=13, family="Georgia", hjust=0, face="italic", color="#8E8883", margin = margin(10, 22, 22, 0)),
axis.title = element_text(family = "Franklin Gothic Book",size=12, color="#000000", margin = margin(22, 0, 22, 0)),
axis.text=element_text(size=10),
plot.caption=element_text(family = "Georgia", hjust = 0, size=9, face="italic", color="black")
)
# read the data
FIR_crime_data <- read_csv("Full_FIR_Details_2008to2015.csv")
FIR_crime_data$`Crime Type` <- ifelse(FIR_crime_data$`Crime Type` == "bulgery", "burglary", FIR_crime_data$`Crime Type`)
# rename a variable name to its English equivalent
colnames(FIR_crime_data)[1] <- "Neighborhood"
# filter the data for only 2014
FIR_crime_data$year <- substring(FIR_crime_data$Date,7,10)
crimeLahore <- FIR_crime_data %>% filter(year=="14")
############---------EIGHT GRAPHS----------###########
#Graph 1: Bar Chart - plot the number of crime incidences by neighborhoods
by_neighborhood <- group_by(crimeLahore, Neighborhood, `Crime Type`)
summ_crimes_by_neighborhood_and_type <- summarise(by_neighborhood, freq = n())
ggplot(data=summ_crimes_by_neighborhood_and_type, aes(x = Neighborhood, y= freq)) +
geom_bar(stat="identity", width=0.7, fill="tomato2") +
theme(aspect.ratio = .6) +
scale_y_continuous(breaks = (seq(0, 15000, by = 2500))) +
labs(title = "South of Lahore is the most dangerous part of the city", x = "Neighborhood", y = "Number of Crime Incidences", subtitle="Highest number of crime occurrences took place in the Southeast part of Lahore in 2014.", caption = "Source: Punjab Police Department") +
scale_x_discrete(limits=c("Iqbal Town", "Nishtar Town", "Ravi Town", "Shalamar Town", "Cantonment", "Wagha Town", "Aziz Bhatti Town", "Data Gunj Baksh", "Samanabad Town", "Gulberg Town")) +
theme_fancy +
#geom_vline(xintercept = 1, yintercept = 2500, color = "red", linetype = "dashed") +
#annotate("text", x = c(2,4,6,8), y=10000, label = c("two", "ship", "six", "boat")) +
theme(axis.text.x = element_text(angle=65, vjust=0.6))
by_crime_type <- group_by(crimeLahore, `Crime Type`) %>% summarise(freq = n())
desc_crimetype <- arrange(by_crime_type, desc(freq))[1:15, ]
# remove "misc" and "other crimes" as they create noise in the data
crime_type_final <- filter(crimeLahore, `Crime Type` %in% desc_crimetype$`Crime Type` & (`Crime Type` != "othercrimes") & (`Crime Type` != "miscellaneous"))
final_by_neighborhood <- group_by(crime_type_final, Neighborhood, `Crime Type`) %>%  summarise(freq = n())
ggplot(data=final_by_neighborhood, aes(x = Neighborhood, y = `Crime Type`, size=freq, color=freq)) +
geom_point() +
labs(title = "Top 15 common types of crime in Lahore", x = "Neighborhood", y = "Type of crime", subtitle="Number of crime incidences of various crime types in \ndifferent neighborhoods in 2014.", caption = "Source: Punjab Police Department") +
guides(color=guide_legend(title="Number of \nCrime Incidences"), size=guide_legend(title="Number of \nCrime Incidences")) +
scale_color_gradient(low="#f8d5d4", high="#E82D17", limits=c(0, 1000)) +
scale_size_continuous(limits=c(0, 1000), breaks=seq(0,1000, by=250)) +
theme_simple_no_border +
theme(aspect.ratio = 1.0) +
theme(panel.background = element_rect(fill = '#fce39e')) +
theme(axis.text.x = element_text(angle=90, vjust=0.6))
ggplot(data=final_by_neighborhood, aes(x = Neighborhood, y = `Crime Type`, size=freq, color=freq)) +
geom_point() +
labs(title = "Top 15 common types of crime in Lahore", x = "Neighborhood", y = "Type of crime", subtitle="Number of crime incidences of various crime types in \ndifferent neighborhoods in 2014.", caption = "Source: Punjab Police Department") +
guides(color=guide_legend(title="Number of \nCrime Incidences"), size=guide_legend(title="Number of \nCrime Incidences")) +
scale_color_gradient(low="#f8d5d4", high="#E82D17", limits=c(0, 1000)) +
scale_size_continuous(limits=c(0, 1000), breaks=seq(0,1000, by=250)) +
theme_simple +
theme(aspect.ratio = 1.0) +
theme(panel.background = element_rect(fill = '#fce39e')) +
theme(axis.text.x = element_text(angle=90, vjust=0.6))
ggplot(data=final_by_neighborhood, aes(x = Neighborhood, y = `Crime Type`, size=freq, color=freq)) +
geom_point() +
labs(title = "Robbery and motorcycle theft are highly prevelant in Lahore", x = "Neighborhood", y = "Type of crime", subtitle="Number of crime incidences of various crime types in \ndifferent neighborhoods in 2014.", caption = "Source: Punjab Police Department") +
guides(color=guide_legend(title="Number of \nCrime Incidences"), size=guide_legend(title="Number of \nCrime Incidences")) +
scale_color_gradient(low="#f8d5d4", high="#E82D17", limits=c(0, 1000)) +
scale_size_continuous(limits=c(0, 1000), breaks=seq(0,1000, by=250)) +
theme_simple +
theme(aspect.ratio = 1.0) +
theme(panel.background = element_rect(fill = '#fce39e')) +
theme(axis.text.x = element_text(angle=90, vjust=0.6))
crimeLahore$Date <- dmy(crimeLahore$Date)
crimeLahore$Month <- month(crimeLahore$Date, label = TRUE)
crimeLahore$week_day <- wday(crimeLahore$Date, label = TRUE)
# Fix the time to hours (round off to the nearest hour)
crimeLahore$hour <- hour(crimeLahore$Time)
# summarise the count of crimes according to week day and time
by_wday_crime_count <- crimeLahore %>% group_by(Month, hour) %>% summarise(freq = n())
k <- "00"
by_wday_crime_count$hour <- paste(by_wday_crime_count$hour, k, sep =":")
ggplot(by_wday_crime_count, aes(x = hour, y = Month, fill = freq)) +
geom_tile() +
scale_x_discrete(limits = c("0:00", "1:00", "2:00", "3:00", "4:00", "5:00", "6:00", "7:00", "8:00", "9:00", "10:00", "11:00", "12:00", "13:00", "14:00", "15:00", "16:00", "17:00", "18:00", "19:00", "20:00", "21:00", "22:00", "23:00")) +
continuousColorScale(600) +
labs(title = "Crime distribution across different months is evenly spread", x = "Hour of the day", y = "Month", subtitle="Crime rate was consistent across different months in 2014, \nbut most incidences took place between noon and midnight.", caption = "Source: Punjab Police Department") +
theme_simple +
theme(axis.text.x=element_text(size=7)) +
guides(color=guide_legend(title="Number of \nCrime Incidences")) +
theme(aspect.ratio = 0.7)
theme(panel.border = element_rect(linetype = "blank"))
# first, convert the crime types into a list
crime_type_list <- list(desc_crimetype$`Crime Type`)
# include a crimeLahore column in the crime dataframe that refers to the category of a particular crime type
crimeLahore <- crimeLahore %>% mutate(Crime_type_category = ifelse(`Crime Type` %in% crime_type_list, "", NA))
#codify by creating a tribble with crime types and their crime categories
crime_categories <-
tribble(
~`Crime Type`, ~Crime_Category,
"miscellaneous", "Miscellaneous",
"othercrimes", "Other Crimes",
"motorcycletheft", "Crimes Against Property",
"robbery", "Crimes Against Property",
"armsordinanceact", "Other Crimes",
"narcotics", "Other Crimes",
"burglary", "Crimes Against Property",
"antinorcoticsact", "Other Crimes",
"beggingact", "Crimes Against Person",
"chequedishonour", "Crimes Against Person",
"overspeeding", "Other Crimes",
"cartheft", "Crimes Against Property",
"gambling", "Crimes Against Person",
"pricecontrol", "Other Crimes",
"othervehicletheft", "Crimes Against Property",
"attemptedmurder", "Crimes Against Person",
"dengueact", "Other Crimes",
"kiteflyingact","Other Crimes",
"kidnapping", "Crimes Against Person",
"loudspeakeract", "Other Crimes",
"telephoneact", "Other Crimes",
"hurtpersonalfeud", "Crimes Against Person",
"attackongovtservant", "Crimes Against Person",
"localgovernment", "Other Crimes",
"outragingthemodestyofwomen", "Crimes Against Person",
"electricityact", "Crimes Against Property",
"murder", "Crimes Against Person",
"ppc", "Other Crimes",
"motorcyclesnatching", "Crimes Against Property",
"ocrimeLahoreheeling", "Other Crimes",
"fatalaccident", "Other Crimes",
"kidnappingminors", "Crimes Against Person",
"rape", "Crimes Against Person",
"tresspassing", "Other Crimes",
"illegalextortion", "Other Crimes",
"nonfatalaccident", "Other Crimes",
"blindmurder", "Crimes Against Person",
"gangrape", "Crimes Against Person",
"policeencounter", "Other Crimes",
"hubsebeja", "Other Crimes",
"dacoity", "Crimes Against Property",
"copyrightact", "Other Crimes",
"antiterrorism", "Other Crimes",
"policeorder", "Other Crimes",
"illegalgascylinder", "Other Crimes",
"carsnatching", "Crimes Against Property",
"dacoitywithmurder", "Crimes Against Property",
"secratarianism", "Other Crimes",
"othervehiclesnatching", "Crimes Against Property",
"kidnapforransom", "Crimes Against Person",
"bordercrossing", "Other Crimes",
"cigretteact", "Other Crimes"
)
# left join on both tables
crimeLahore_merge <- left_join(crimeLahore, crime_categories, by = c("Crime Type" = "Crime Type"))
#groupby on crime category and crime type
by_crime_cat_crime_count <- crimeLahore_merge %>% group_by(Crime_Category, `Crime Type`) %>% summarise(freq = n())
ggplot(by_crime_cat_crime_count, aes(area = freq, fill = Crime_Category, label = `Crime Type`, subgroup = Crime_Category)) +
geom_treemap() +
geom_treemap_text(colour = "white", place = "centre", grow = TRUE) +
ordinalColorScale_fill +
labs(title = "Crimes committed against property exceed the crimes committed against person", subtitle="''Other Crimes'' which includes narcotics and overspeeding, was the major category of crimes committed in 2014.", caption = "Source: Punjab Police Department", fill = "Crime Category") +
theme(aspect.ratio = 0.7) + theme_simple
ggplot(by_crime_cat_crime_count, aes(area = freq, fill = Crime_Category, label = `Crime Type`, subgroup = Crime_Category)) +
geom_treemap() +
geom_treemap_text(colour = "white", place = "centre", grow = TRUE) +
ordinalColorScale_fill +
labs(title = "Crimes committed against property exceed the crimes committed against person", subtitle="''Other Crimes'' which includes narcotics and overspeeding, was the major category of crimes committed in 2014.", caption = "Source: Punjab Police Department", fill = "Crime Category") +
theme(aspect.ratio = 0.7) + theme_simple
crimeLahore_merge <- left_join(crimeLahore, crime_categories, by = c("Crime Type" = "Crime Type"))
#groupby on crime category and crime type
by_crime_cat_crime_count <- crimeLahore_merge %>% group_by(Crime_Category, `Crime Type`) %>% summarise(freq = n())
ggplot(by_crime_cat_crime_count, aes(area = freq, fill = Crime_Category, label = `Crime Type`, subgroup = Crime_Category)) +
geom_treemap() +
geom_treemap_text(colour = "white", place = "centre", grow = TRUE) +
ordinalColorScale_fill +
labs(title = "Crimes committed against property exceed the crimes committed against person", subtitle="''Other Crimes'' which includes narcotics and overspeeding, was the major category of crimes committed in 2014.", caption = "Source: Punjab Police Department", fill = "Crime Category") +
theme(aspect.ratio = 0.7) + theme_simple
# Graph 5: Line Chart - how have different crime categories crime count changed over time?
by_month_crime_type_cat <- group_by(crimeLahore_merge, Crime_Category, Month)  %>% summarise(freq = n())
#by_month_crime_type_cat
#by_month_crime_type_cat$Month <- as.Date(by_month_crime_type_cat$Month)
ggplot(by_month_crime_type_cat, aes(Month, freq, group = Crime_Category, color = Crime_Category)) +
geom_line(size = 1) + geom_point(size = 2) +
ordinalColorScale_color +
labs(title="Crimes against person decrease throughout the year",
subtitle="Miscellaneous Crimes and Other Crimes follow the same pattern, \nespecially in the second half of 2014.",
caption="Source: Punjab Police Department",
y="Number of Crime Incidences",
colour = "Crime Category") +
theme(aspect.ratio = 1.0) +
theme_fancy
# Graph 6: Time-series calendar heatmap
# on data from 2010 to 2014
# first let's use lubridate library to extract datetime values
crimeLahore_all_data <- FIR_crime_data %>% filter(year %in% c("10", "11", "12", "13", "14"))
crimeLahore_all_data$Date <- dmy(crimeLahore_all_data$Date)
crimeLahore_all_data$Month <- month(crimeLahore_all_data$Date, label = TRUE)
crimeLahore_all_data$day <- day(crimeLahore_all_data$Date)
crimeLahore_all_data$monthweek <- ceiling(crimeLahore_all_data$day/ 7)
crimeLahore_all_data$year <- year(crimeLahore_all_data$Date)
crimeLahore_all_data$week_day <- wday(crimeLahore_all_data$Date, label = TRUE)
crimeLahore_all_data
# groupby on year, month, monthweek and weekday
crimeLahore_all_data_crime_count <- crimeLahore_all_data %>% group_by(year, Month, monthweek, week_day) %>% dplyr::summarise(freq_ = n())
ggplot(crimeLahore_all_data_crime_count, aes(x=monthweek, y=week_day, fill = freq_)) +
geom_tile(colour = "white") +
facet_grid(year ~ Month) +
continuousColorScale(300) +
#scale_fill_gradient(low="#f8d5d4", high="#E82D17", limits=c(0, 300)) +
labs(x="Week of Month",
y="Day of the Week",
title = "Crime rate of Lahore has increased by 600 times since 2010",
subtitle="Urbanization, migration and presence of militant groups have significantly contributed \nto the spike in the crime rate of Lahore.",
caption = "Source: Punjab Police Department",
fill="Number of \nCrime Incidences") +
theme_simple +
theme(aspect.ratio = 1.4)
# Graph 7: Diverging bars - are different types of crime above or below the average crime rate?
#Find total number of crimes for the year 2014, calculate its mean and standardize
count_all_crime_types <- crimeLahore %>% group_by(`Crime Type`) %>% dplyr::summarise(freq_ = n())
count_all_crime_types$freq_z <- round((count_all_crime_types$freq_ - mean(count_all_crime_types$freq_))/sd(count_all_crime_types$freq_), 2)
#Show crime types for only top 25 crime types with high frequency of crime events
count_all_crime_types <- arrange(count_all_crime_types, desc(freq_))[1:25, ]
#calculate whether a crime type is above/below the average standardized crime rate and order it
count_all_crime_types$crime_type_status <- ifelse(count_all_crime_types$freq_z < 0, "below", "above")  # above / below avg flag
count_all_crime_types <- count_all_crime_types[order(count_all_crime_types$freq_z), ]
count_all_crime_types$`Crime Type` <- factor(count_all_crime_types$`Crime Type`, levels = count_all_crime_types$`Crime Type`)
ggplot(data = count_all_crime_types, aes(x=`Crime Type`, y=freq_z, label=freq_z)) +
geom_bar(stat='identity', aes(fill=crime_type_status), width=.5)  +
scale_fill_manual(name="Total Number of \nCrime Incidences",
labels = c("Above Average", "Below Average"),
values = c("above"="#00ba38", "below"="#f8766d")) +
labs(x="Crime Type",
y="Deviation from zero",
title = "Only 25% of all crime types are the most significant",
subtitle="Most crime types below the average number of crime incidences have the same frequency where as \ncrime types above average have a large difference in crime frequency between each other.",
caption = "Source: Punjab Police Department",
fill="Number of \nCrime Incidences") +
coord_flip() + theme_fancy
by_crime_cat_crime_count
ggplot(by_crime_cat_crime_count, aes(area = freq, fill = Crime_Category, label = `Crime Type`, subgroup = Crime_Category)) +
geom_treemap() +
geom_treemap_text(colour = "white", place = "centre", grow = TRUE) +
ordinalColorScale_fill +
labs(title = "Crimes committed against property exceed the crimes committed against person", subtitle="''Other Crimes'' which includes narcotics and overspeeding, was the major category of crimes committed in 2014.", caption = "Source: Punjab Police Department", fill = "Crime Category") +
theme(aspect.ratio = 0.7) + theme_simple
ggplot(by_crime_cat_crime_count, aes(area = freq, fill = Crime_Category, label = `Crime Type`, subgroup = Crime_Category)) +
geom_treemap() +
geom_treemap_text(colour = "white", place = "centre", grow = TRUE)
ggplot(by_crime_cat_crime_count, aes(area = freq, fill = Crime_Category, label = `Crime Type`, subgroup = Crime_Category)) +
geom_treemap()
crime_type_list
ggplot(by_month_crime_type_cat, aes(Month, freq, group = Crime_Category, color = Crime_Category)) +
geom_line(size = 1) + geom_point(size = 2) +
ordinalColorScale_color +
labs(title="Crimes against person decrease throughout the year",
subtitle="Miscellaneous Crimes and Other Crimes follow the same pattern, \nespecially in the second half of 2014.",
caption="Source: Punjab Police Department",
y="Number of Crime Incidences",
colour = "Crime Category") +
theme(aspect.ratio = 1.0) +
theme_fancy
crimeLahore_merge <- left_join(crimeLahore, crime_categories, by = c("Crime Type" = "Crime Type"))
crimeLahore_merge
by_crime_cat_crime_count <- crimeLahore_merge %>% group_by(Crime_Category, `Crime Type`) %>% summarise(freq = n())
ggplot(by_crime_cat_crime_count, aes(area = freq, fill = Crime_Category, label = `Crime Type`, subgroup = Crime_Category)) +
geom_treemap() +
geom_treemap_text(colour = "white", place = "centre", grow = TRUE) +
ordinalColorScale_fill +
labs(title = "Crimes committed against property exceed the crimes committed against person", subtitle="''Other Crimes'' which includes narcotics and overspeeding, was the major category of crimes committed in 2014.", caption = "Source: Punjab Police Department", fill = "Crime Category") +
theme(aspect.ratio = 0.7) + theme_simple
ordinalColorScale_color = scale_color_brewer(palette = "Dark2")
ordinalColorScale_fill = scale_fill_brewer(palette = "Dark2")
ggplot(by_crime_cat_crime_count, aes(area = freq, fill = Crime_Category, label = `Crime Type`, subgroup = Crime_Category)) +
geom_treemap() +
geom_treemap_text(colour = "white", place = "centre", grow = TRUE) +
ordinalColorScale_fill +
labs(title = "Crimes committed against property exceed the crimes committed against person", subtitle="''Other Crimes'' which includes narcotics and overspeeding, was the major category of crimes committed in 2014.", caption = "Source: Punjab Police Department", fill = "Crime Category") +
theme(aspect.ratio = 0.7) + theme_simple
ggplot(by_crime_cat_crime_count, aes(area = freq, fill = Crime_Category, label = `Crime Type`, subgroup = Crime_Category)) +
geom_treemap() +
geom_treemap_text(colour = "white", place = "centre", grow = TRUE) +
ordinalColorScale_fill +
labs(title = "Crimes committed against property exceed the crimes committed against person", subtitle="''Other Crimes'' which includes narcotics and overspeeding, was the major category of crimes committed in 2014.", caption = "Source: Punjab Police Department", fill = "Crime Category") +
theme(aspect.ratio = 0.7) + theme_simple
